{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/student_hub/hub_navbar.css' %}" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

    <title>Document</title>
</head>

<style>
    body {
        background-color: white;
        font-family: Helvetica, sans-serif;
    }

    img {
        -webkit-user-drag: none;
    }

    #submission-div {
        padding-left: 17vw;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 30px;
    }

    .guidelines {
        flex-grow: 1;
        background-color: black;
        /* width: 400px; */
        border-radius: 15px;

        display: flex;
        flex-direction: column;
        padding: 10px 20px;
        transition: all 1s;

    }

    .guidelines-title {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
        width: 55vw;
    }

    .guidelines h3 {
        color: white;
        font-size: clamp(14px, 1.2vw, 2vw);
    }

    .guidelines img {
        height: 20px;
    }

    .guidelines:hover {
        cursor: pointer;
    }

    .guidelines li {
        color: white;
        max-width: 40vw;
        line-height: 2;
        /* margin-bottom: 10px; */
    }

    .submission-hub-title {
        font-weight: bold;
        font-size: clamp(25px, 2.2vw, 4vw);
        text-align: center;
    }

    #guidelines-paragraph {
        display: none;
    }

    #submission-remove-btn {
        display: none;
        height: 4px;

    }

    .guidelines-div-container {
        width: 56vw;
        margin-left: -15px;

    }

    .guidelines-div-container p {
        color: #898989;
    }

    @media (max-width: 1050px) {

        #submission-div {
            padding-left: 90px;
            padding-right: 20px;
        }

        .guidelines-title {

            /* gap: 35vw; */
            width: 70vw;
        }


        .guidelines-div-container {
            width: 73.5vw;
        }

        .guidelines li {
            color: white;
            max-width: 50vw;
            line-height: 2;
            /* margin-bottom: 10px; */
        }

    }

    @media (max-width: 700px) {
        /* #submission-div {
            padding-left: 20vw;
            padding-right: 2vw;
        } */
        /* 
        #submission-div {
            padding-left: 120px;
            padding-right: 20px;
        } */

        .guidelines-title {

            width: 60vw;
        }

        .guidelines-div-container {
            width: 63.5vw;
        }


        .guidelines li {
            color: white;
            max-width: 50vw;
            line-height: 2;
            /* margin-bottom: 10px; */
        }
    }
</style>

<body>
    {% include 'participant_hub/hub_navbar.html' %}

    <section id="submission-div">
        <h2 class="submission-hub-title">
            Submission
        </h2>
        <div class="guidelines" id="guidelines">
            <div class="guidelines-title ">
                <h3>
                    Submission Guidelines
                </h3>
                <img src="{% static 'img/add_btn.svg' %}" id="submission-add-btn" />
                <img src="{% static 'img/remove_btn.svg' %}" id="submission-remove-btn" />
            </div>
            <div id="guidelines-paragraph">
                <p>
                <ol>
                    <li>
                        Eligibility: Participants must meet the eligibility criteria specified for the hackathon,
                        including
                        age, skill level, and any other relevant requirements.
                    </li>
                    <li>
                        Team Size: Teams should consist of the maximum number of members allowed, as specified in the
                        hackathon guidelines. No exceptions will be made.
                    </li>
                    <li>
                        Registration: All participants must register in advance through the official registration
                        process.
                        Late registrations may not be accepted.
                    </li>
                    <li>
                        Code of Conduct: Respectful and inclusive behavior is expected from all participants.
                        Harassment,
                        discrimination, or any form of misconduct will not be tolerated.
                    </li>
                </ol>
                </p>
            </div>

        </div>


        <h2 class="submission-hub-title">
            Submission Form
        </h2>

        <style>
            .submission-input {
                width: 97%;
                border: 1.99px solid #EBEBEB;
                border-radius: 10.932px;

                /* height: 84px; */
                padding: 20px 20px;
                color: #000000;
                font-family: Helvetica;
                font-size: 15px;
                font-style: normal;
                font-weight: 700;
                line-height: normal;

            }

            .submission-input::placeholder {
                color: #9b9b9b;
                font-family: Helvetica;
                font-size: 15px;
                font-style: normal;
                font-weight: 700;
                line-height: normal;
            }

            .submission-form-content {
                display: flex;
                flex-direction: column;
                gap: 0px;
            }

            .submission-textarea {
                width: 97%;
                height: 100px;
                border: 1.99px solid #EBEBEB;
                border-radius: 10.932px;

                /* height: 84px; */
                padding: 20px 20px;
                color: #000000;
                font-family: Helvetica;
                font-size: 15px;
                font-style: normal;
                font-weight: 700;
                line-height: normal;
                resize: none;
            }

            .submission-textarea::placeholder {
                color: #9b9b9b;
                font-family: Helvetica;
                font-size: 15px;
                font-style: normal;
                font-weight: 700;
                line-height: normal;
            }
        </style>



        <style>
            select {
                /* display: flex;
                flex-direction: column; */
                /* padding: 100px; */
                width: clamp(240px, 27.4vw, 30.4vw);
                padding: 20px 20px;
                border: 1.99px solid #EBEBEB;
                border-radius: 10.932px;
                color: #9b9b9b;
                font-family: Helvetica;
                font-size: 15px;
                font-style: normal;
                font-weight: 700;
                line-height: normal;
            }

            select option {
                /* padding: 20px 20px; */
                /* padding-bottom: 100px; */
                color: #000000;
                font-family: Helvetica;
                font-size: 15px;
                font-style: normal;
                font-weight: 700;
                line-height: normal;
            }

            #submit-btn {
                /* width: 102%; */
                margin-top: 20px;
                margin-bottom: 50px;
                display: flex;
                justify-content: center;
                background-color: black;
                border-radius: 10.932px;
                font-size: 17px;
                font-family: Helvetica;
                color: white;
                padding-left: 20px;
                margin-right: 20px;
                /* margin-left: -15px; */

                cursor: pointer;

            }
        </style>

        <div class="submission-form-content">
            <div class="guidelines-div-container">
                <h3>
                    Choose Case Study

                </h3>

                <select id="case-studies">
                    <option>Choose Case Study</option>
                    <option>Enteratinement</option>
                    <option>Art</option>
                    <option>Enteratinement</option>
                    <option>Wild Card</option>
                </select>
                <p>
                </p>
            </div>
            <div class="guidelines-div-container">
                <h3>
                    Enter Project Name
                </h3>
                <input type="text" placeholder="Project Name" class="submission-input" id="project-name" value="{{project_name}}">
                <p>
                    Note: Once you have joined a group you cannot change the group.
                </p>
            </div>
            <div class="guidelines-div-container">
                <h3>
                    Enter Project Image Link
                </h3>
                <input type="text" placeholder="Image Link" class="submission-input" id="project-image" value="{{project_image}}">
                <p>
                    Note: The Project image link needs to be public in order for our judges to access.<br>
                    Format:
                </p>
            </div>
            <div class="guidelines-div-container">
                <h3>
                    Enter Project Description
                </h3>
                <textarea placeholder="Project Description" class="submission-textarea" maxlength="300"
                    id="project-description">{{project_description}}</textarea>
                <p>
                    Note: Describe your project in 300 characters
                </p>
            </div>
            <div class="guidelines-div-container">
                <h3>
                    Enter GitHub Repository Link
                </h3>
                <input type="text" placeholder="Repository Link" class="submission-input" id="github-link" value="{{project_github}}">
                <p>
                    Note: The GitHub repository needs to be public in order for our judges to access<br>
                    Format:
                </p>
            </div>
            <div class="guidelines-div-container">
                <h3>
                    Enter Pitch Deck PDF Link
                </h3>
                <input type="text" placeholder="Pitch Deck Link" class="submission-input" id="pitch-link" value="{{project_pdf}}">
                <p>
                    Note: The slides link needs to be public in order for our judges to access.<br>Format:
                </p>
            </div>
            <div class="guidelines-div-container">
                <h3>
                    Enter Presentation Video Link
                </h3>
                <input type="text" placeholder="Presentation Video Link" class="submission-input" id="video-link" value="{{project_video}}">
                <p>
                    Note: The presentation video link needs to be public in order for our judges to access.<br>
                    Format:
                </p>
            </div>
            <div id="submit-btn">
                <h3>Submit Project</h3>
            </div>
        </div>

    </section>



    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Get references to the clickable divs
            const guidelines = document.getElementById('guidelines');
            const guide_para = document.getElementById('guidelines-paragraph');
            const add_btn = document.getElementById('submission-add-btn');
            const remove_btn = document.getElementById('submission-remove-btn');

            guidelines.addEventListener('click', function () {
                if (guide_para.style.display === "none" || guide_para.style.display === "") {
                    guide_para.style.display = "block";
                    remove_btn.style.display = "block";
                    add_btn.style.display = "none";
                } else {
                    guide_para.style.display = "none";
                    remove_btn.style.display = "none";
                    add_btn.style.display = "block";
                }
            });
        });

    </script>

    <script>

        const submit_btn = document.getElementById("submit-btn");


        function setCookie(name, value, daysToExpire) {
            // Calculate the expiration date
            const expirationDate = new Date();
            expirationDate.setDate(expirationDate.getDate() + daysToExpire);

            // Format the cookie string
            const cookieString = `${name}=${encodeURIComponent(value)}; expires=${expirationDate.toUTCString()}; path=/`;

            // Set the cookie
            document.cookie = cookieString;
        }
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        submit_btn.addEventListener('click', function () {

            let case_study = document.getElementById('case-studies');
            case_study = case_study.value;
            // case_study = case_study.options[case_study.selectedIndex].text;


            const projectNameInput = document.getElementById('project-name');
            const projectImageInput = document.getElementById('project-image');
            const projectDescriptionTextarea = document.getElementById('project-description');
            const githubLinkInput = document.getElementById('github-link');
            const pitchLinkInput = document.getElementById('pitch-link');
            const videoLinkInput = document.getElementById('video-link');

            // Trim the values of the input and textarea elements
            const trimmedProjectName = projectNameInput.value.trim();
            const trimmedProjectImage = projectImageInput.value.trim();
            const trimmedProjectDescription = projectDescriptionTextarea.value.trim();
            const trimmedGithubLink = githubLinkInput.value.trim();
            const trimmedPitchLink = pitchLinkInput.value.trim();
            const trimmedVideoLink = videoLinkInput.value.trim();

            console.log("Case Study: ", case_study)
            console.log('Project Name:', trimmedProjectName);
            console.log('Project Image Link:', trimmedProjectImage);
            console.log('Project Description:', trimmedProjectDescription);
            console.log('GitHub Repository Link:', trimmedGithubLink);
            console.log('Pitch Deck Link:', trimmedPitchLink);
            console.log('Presentation Video Link:', trimmedVideoLink);

            var csrftoken = getCookie('csrftoken');
            console.log(csrftoken);
            var headers = new Headers();
            headers.append('X-CSRFToken', csrftoken);


            const formData = new FormData();
            formData.append("case_study", case_study);
            formData.append("project_name", trimmedProjectName);
            formData.append("project_image", trimmedProjectImage);
            formData.append("project_description", trimmedProjectDescription);
            formData.append("project_github", trimmedGithubLink);
            formData.append("project_pdf", trimmedPitchLink);
            formData.append("project_video", trimmedVideoLink);

            // formData.append("data", create_group_input.value.trim());
            fetch('/submission/', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': getCookie("csrftoken")
                },
                credentials: 'include'
            }).then(response => {
                if (response.status === 200) {
                    response.json().then(data => {
                        if (data.status === 'success') {
                            console.log("Yay");
                            window.location.href = '/submission/project'; 
                            // const session_auth = data.session_auth;
                            // setCookie("session_auth", session_auth, 7);
                            // window.location.href = '/groups/hub'; // Redirect to the desired page
                        } else {

                            console.log("Noo");
                            // create_group_input.style.border = "2px solid red";
                            // const msg = data.msg;
                            // create_group_error.style.color = "red";
                            // create_group_error.innerHTML = msg;
                            // console.log("error")
                        }
                    });
                } else {
                    console.log("error")
                }
            })
                .catch(error => {
                    console.log("error")
                });
        });


    </script>

<script>
    function changeSelectedOptionByValue(newValue) {
        // Get a reference to the select element
        var selectElement = document.getElementById('case-studies');

        // Iterate through the options to find the one with the desired value
        for (var i = 0; i < selectElement.options.length; i++) {
            if (selectElement.options[i].value === newValue) {
                // Set the selected attribute for the matching option
                selectElement.options[i].selected = true;
                break; // Exit the loop once a match is found
            }
        }
    }
    changeSelectedOptionByValue("{{case_study}}")
</script>



</body>

</html>